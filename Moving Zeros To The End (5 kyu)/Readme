Most ugly thing i have ever written but it works
